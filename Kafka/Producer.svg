<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1081.611908250383 437.63934589501946" width="1081.611908250383" height="437.63934589501946" filter="invert(93%) hue-rotate(180deg)">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 --><!-- payload-start -->eyJ2ZXJzaW9uIjoiMSIsImVuY29kaW5nIjoiYnN0cmluZyIsImNvbXByZXNzZWQiOnRydWUsImVuY29kZWQiOiJ4nO2ZeU/b2Fx1MDAxYYf/76ewUl1pRiqesy+V7pUgLVx1MDAwM1x1MDAwNVx1MDAwMpRhXHUwMDFkRsjYJ7HBsYPtbK363ec9XHUwMDBlJVx1MDAwZU4gd0opmplcYlx1MDAwMTmLz/Z73uX48yvHaVx1MDAxNOOeabx1XHUwMDFhZuR7cVx1MDAxNGTesPHGllx1MDAwZkyWR2lcdTAwMDJVpPyep/3ML1uGRdHL3/7yy7SH66fdSS9cdTAwMTObrkmKXHUwMDFj2v1cdTAwMGXfXHUwMDFk53P5uzJOZvzCSzqxKTuUVdOhMOXsfnErTcpxMeGUXHTJ0LRFlL+DXHUwMDAxXHUwMDBiXHUwMDEzQHXbi3MzrbFFjbOti19pK2CtZPVmPd3Ye9fZi7rTcdtRXHUwMDFjXHUwMDFmXHUwMDE047icV57CWqZ1eZGl1+Y4XG6K0I59r3xRryztd8LE5PlMn7Tn+VExtmVcYt2VTjbhrTMtXHUwMDE52c2WzKWSc6k5I1xccXlXa/tcdTAwMTOqXFylNaZcdTAwMDRJrlx1MDAxNdXy3sSaaZxmdmKvUfmZTu3S8687ML8kmLYx5WfaZni7XFzCmKuYUkxcIqwoY/SuRWiiTliUTZCLXHUwMDE5XCJcdTAwMThcdTAwMGWFacymh5Kb8jw45VgoRabLs6P3NoOpNspSntBcdTAwMWS6tz/AXHUwMDFmgqPDjY2j9+OjU924rf/j/r6HXta73d9Gbr9UXHUwMDE2aNf2fqK/2iiHO3tcdTAwMWSYXHUwMDBmw8eXXHUwMDA3Z/v6eq/bWjmuj9LvXHUwMDA13kROWFBNXGLBijPGy+ovb+ZcdTAwMGK6MKNinpalpoukLCUlUiC1vJJcdTAwMTFcdTAwMGX3XHUwMDA3n1pcdTAwMWbWd/DwKr4o3u2qkX7ZSqaYuUwgJrVkXHUwMDAydpOJXHUwMDE5KVNKXFzCqFx1MDAwNp1cdTAwMGKukaxU/1x1MDAxNSn7JmCBV5cyXHUwMDE2yFx1MDAxNVxiUaEpUlxumOF1LTPuQpXCWiGwMbgmZYw4hd6MqFx1MDAxZqjlR0U6XHUwMDE1Q5pcdTAwMTRcdTAwMDfRJ3tcIlS6mjBCXHUwMDEwXHUwMDAy8VOG1Uyjda9cdTAwMWLF45lcdTAwMDMuxVxm89nL0qDvm6y66bmJo6R8Kl6wX7b3alx1MDAxY3Ws/Fx1MDAxYj7MvfpcdTAwMDBgoIjAY9w1KNJe40GyXHUwMDFlc1x1MDAxNXJcdTAwMTFfmGrBXHUwMDA1U1IsXHLYRbChPu6t6fD0sNnKeqZzPWI3L1x1MDAxYjCMXHRxKVwiXG5jXHUwMDEwJ6bqnq9cdTAwMTDYXHUwMDA1qlxiXHUwMDE4c8wxlvSb+FJCXHUwMDE5LebwpVx1MDAwNIxCXHUwMDAxb85cdTAwMTGIUbI6X+BDXFzMXHSW4NKYhsakTlx1MDAxOOaIUPEoYWG8ttLUUbzZ5X4zVb/y7UO0fzcraPAp7VC9vbJ7obqbW4NU7jbP0qvnQvBcdTAwMWLUzClaqGZNqKawP2ppNW+LNDfY22Yn782IdVdWTtlK8tLVjCGiwFxiXHUwMDA0XHUwMDBicmWMkVk1M+1KoTlSgmgtecWUPam7eFx1MDAxYTlTITBWSPxj5SzwYuOstNJwfmhpNW9utU50Z+Dx0c5NuJlcZvFue2PzhatcdTAwMTlp4XJOQbJWs3I29lx1MDAwMUtcdTAwMDdBPlx1MDAwM1x1MDAwYk00QpJq/k1iXlx1MDAxNMY/kZgxglRcdTAwMDBmSl6ymH9oqI+xIIvkriVChEGLpeV+3byI1MdcdTAwMTMx2jq6SI53m9dcdTAwMWaGZ9lcdTAwMGKXO2SkLlNIXHUwMDEyJTiS1WCj1LtSLlGSXHUwMDBiSsHTI0K+Se5cdTAwMGJtd8Un3Olb1qJ5LVx1MDAxNIOp8sfk/ENN77xgnihcdTAwMWLMU4hsXHUwMDE1XHUwMDExsIjKJj9cdTAwMTLNb3nta+88acb9XHUwMDFjQvJ8blAv6Ey3J1xi4ydqxsn22lx1MDAxMHVG44/+8U5ebFx1MDAxZqGx3p4+bj5aVlNcdTAwMDJxlyvJNFVcdTAwMWFi+cpccsMkXHUwMDFlkK5cdTAwMDKpgGmCXHUwMDAwmPC6XHUwMDFh2Fx1MDAxY2vHXHUwMDFmXHUwMDEy8l/QYpF5Sd7zMtijXHUwMDA1gIaeXHUwMDFm9jPznIhW5fz/6PSrvefWNVx1MDAxMUxrJs2mfpUg9L5fl4IxSPfVMmFqnYmkXHUwMDFmx49QIWrCPjBJ4HRhOV7H5OfVXGK3glxyWlx1MDAwNpM7OcemXTyi9nn4MPpcdTAwMDBcdTAwMDMmXHUwMDE5h6aJdLDdzNfPxlvKQLS7XGZcdTAwMDOcaMtcdTAwMDC3OVx1MDAxY4PQmM8wYG9YsNZaYaHAx1NcXIOA8zkmUfxcdTAwMGLBo1x1MDAxMEBARCGlJrXbaOtSXHUwMDFlcvZYMU3E90CAwqNcdTAwMTWtIbDZdoqoa9J+4fz3f05mimz8xjlInaFxuvbAXHUwMDAxXHUwMDBmUzhBv1x1MDAxN4OOXHUwMDBic0eLXHUwMDEzmsw458kwNImTXHUwMDAzR1HScezpOkVoXHUwMDFj+zeG5q5T+lx1MDAwZWhcdTAwMWP3cqd/2+tyXGb/2vbnjfcjzy/i8Xmym5jzhnNgul5cdTAwMDLE5E4vM1x1MDAwM1iZ48XxnNHduahWgqTviCqfXHUwMDFm5E1Q7alTst66ueo3TzhBendlMFxcXHUwMDFkL4Mqo9zV4K6UlJpAjCFnWcVcdTAwMWHZak4pXHUwMDE3XHUwMDFhfmlWg1VX5Du9Z8d/XHUwMDAzWNH3hVx1MDAxNUsmuVrgsTBSXHUwMDBiXVx1MDAxNmRmmkrJlklFn8hjTXDywzTNjVx1MDAwM+dQRFx1MDAwNUzIKVJA1zfRoFx1MDAwMmg7S7uA0eRcItYyXHUwMDE3enn4U3p5XHUwMDA1mffPzn+c13fdcyfNLPCBaYPEXHUwMDAzx3OuzXhcdTAwMDFhLoc4XHUwMDE5cytTXGKtNH9cdTAwMGXi8EPE8Vx1MDAwYnkyXHUwMDE46JPMS09Ns3cylEdcdTAwMWY7S1x1MDAxMceZS5VNXFwlYVx1MDAwMunZXHUwMDAwXHUwMDExY+1KcI5cXFx1MDAxMqBOo4rR/lxunOJzXmz9Lbzj91x1MDAwNlx1MDAwZUxcdTAwMTWVolx1MDAxYZNXQ0S+kDcuXHUwMDA1XHUwMDA277jMe68n4m3NtFPwWN5cdTAwMTQk35v4O8dLxlx1MDAxNro0XHUwMDBi8jdOVFi8Jlx1MDAxY970TW79ZuHBXHUwMDE4nuNdWudqvaI/SaAmZNqCS7thmVx1MDAwYm70t9BMe/iAklx1MDAxN1x1MDAwMZZRXHUwMDAyo3e9XHUwMDEycfhcdTAwMTmGkVx1MDAxZt52cqK8fERsvMA+XHUwMDEyXGI2IISKTfCS4DypTNyLh944d4ZZVJhyprb7tPnkQa7zUj3r/pVcdTAwMTfuXHUwMDE2mlxmWlx1MDAxZk5/K4rOSnh47C+VXGJcblJyjlx0QVx1MDAxMlE8ezEssMsshJhcdTAwMTMwalxuQK9xTumcVLCilSU4v5RE8X9cdTAwMWPnhCFsTWft1URj9rblXHUwMDFl5sReUYB9eEbMv76vtDFw6WLnUkCfhVx1MDAwMkpcdTAwMWWgYHCp+/Hm4adkVWbr+4PWRdzdUstQoNBDXHUwMDE0QHrgXHUwMDEyoIBIJiBcdTAwMTRCtFx1MDAwNlx1MDAwMXnkduxfZ7fI2TGlMUFcXMxzdqRcdTAwMTKf199zMEGRfk5cZlqpzdzOk1VI337anniWIE3Mz7dFNlx1MDAxOctMmYzlk4pcdTAwMWZ4ZVwi5ISTV7fXqVxyr9c7KGCdUDehpjGIzHBtzlx1MDAxNXC7/Nhrx5IyKzFjN+3zl1df/lx1MDAwNPP16FEifQ==<!-- payload-end -->
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="1081.611908250383" height="437.63934589501946" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 187.49913055010506) rotate(0 122.42442350917213 120.0701076724572)"><path d="M0.36 -1.96 L245.2 -1.54 L245.29 241.79 L-1.13 239.91" stroke="none" stroke-width="0" fill="#eeeeee"></path><path d="M1.44 0.41 C74.17 -0.81, 146.83 -0.43, 243.29 1.55 M0.8 0.27 C89.41 1.02, 179.75 0.36, 245.62 -0.31 M244.02 1.37 C244.11 51.89, 246.02 104.48, 243.84 239.37 M244.56 -0.44 C245.42 92.55, 246.49 184.69, 245.41 240.37 M246.33 239.95 C157.68 242.31, 73.44 239.84, 0.76 239.38 M244.28 240.64 C182.92 238.93, 122.98 238.39, -0.25 240.62 M1.26 241.26 C-2.37 168.44, -1.54 92.95, 0.32 1.19 M-0.18 240.18 C-0.41 144.48, 0.26 50.7, -0.41 -0.49" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(50.08490020405378 280.84399394002855) rotate(0 80.30018465442993 22.942909901265693)"><text x="80.30018465442993" y="31.8858198025314" font-family="Virgil, Segoe UI Emoji" font-size="37.92422005163418px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Producer</text></g><g stroke-linecap="round" transform="translate(857.927231541553 210.3462228892384) rotate(0 93.37169727546143 91.57608771247166)"><path d="M1.72 1.93 L187.44 -0.39 L188.72 181.73 L-1.49 183.96" stroke="none" stroke-width="0" fill="#868e96"></path><path d="M0.85 -1.04 C60.81 2.18, 122.25 -1.6, 185.33 -0.93 M-0.32 -0.98 C60.97 0.79, 123.44 1.02, 185.85 0 M185.74 -0.97 C187.01 47.06, 187.07 90.57, 187.16 184.64 M186.64 0.69 C187.92 65.91, 188.64 134.58, 186.34 183.22 M187.41 183.82 C118.85 182.01, 53.49 182.84, 1.49 181.75 M186.71 183.51 C117.48 183.71, 46.42 184.25, 0.42 183.05 M1.95 181.19 C-1.77 117.25, 0.92 49.21, 0 -1.17 M-0.83 183.19 C1.68 132.56, 0.4 81.49, 0.86 0.29" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(845.7350426088585 198.36950710409627) rotate(0 93.37169727546143 91.57608771247166)"><path d="M1.93 0.7 L186.36 1.98 L185.32 181.66 L0.81 184.73" stroke="none" stroke-width="0" fill="#ced4da"></path><path d="M-1.04 -0.3 C58.56 -0.76, 111.35 -2.21, 185.81 0.59 M-0.98 -0.55 C44.95 1, 90.21 -0.29, 186.74 -0.52 M185.77 0.63 C186.74 51.95, 184.87 102.93, 188.23 184.45 M187.43 -0.48 C186.17 71.76, 188.02 142.63, 186.81 183.68 M187.42 181.23 C127.66 182.46, 70.19 185.26, -1.4 184.64 M187.1 183.81 C115.38 182.63, 44.88 183.51, -0.11 183.85 M-1.96 182.22 C2.45 121.56, 2.2 56.46, -1.17 -0.44 M0.03 183.52 C-0.79 140.4, -0.94 100.32, 0.29 0.86" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(832.1781904082902 184.97425976419504) rotate(0 93.37169727546143 91.57608771247166)"><path d="M0.7 -0.39 L188.72 -1.42 L185.25 183.96 L1.58 183.69" stroke="none" stroke-width="0" fill="#eeeeee"></path><path d="M-0.3 1.99 C54.23 -0.81, 106.97 0.04, 187.33 -1.18 M-0.55 -0.08 C47.64 1.97, 93.59 1.83, 186.22 -0.2 M187.38 1.69 C186.53 37.78, 186.25 77.39, 188.04 184.96 M186.26 -0.9 C186.79 59.12, 186.15 116.39, 187.28 183.27 M184.82 182.37 C133.08 183.84, 83.53 182.38, 1.49 184.76 M187.4 182.81 C121.27 184.01, 57.14 183.71, 0.7 183.61 M-0.93 185.05 C-0.02 135.38, -1.78 83.15, -0.44 -1.43 M0.37 183.48 C0.61 117.13, 2.37 51.01, 0.86 0.96" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(868.1051491081316 236.8875617842233) rotate(0 59 37)"><text x="59" y="26" font-family="Virgil, Segoe UI Emoji" font-size="28.924365682668473px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Kafka</text><text x="59" y="63" font-family="Virgil, Segoe UI Emoji" font-size="28.924365682668473px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Clusters</text></g><g transform="translate(341.2119143538987 196.4000473022461) rotate(0 72 25)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Send messages</text><text x="0" y="43" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr"></text></g><g transform="translate(265.2119448714768 262.7999801635742) rotate(0 279 30)"><text x="0" y="15" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">If timeout =&gt; retry, So we might meet duplicate messages here </text><text x="0" y="35" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">when sending back the ack late. Kafka helps us here by using "Exactly</text><text x="0" y="55" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">One" Semantics prevent all duplicate messages.</text></g><g transform="translate(171.61190825038307 139.58753204345703) rotate(0 450 10.5)"><text x="0" y="15" font-family="Virgil, Segoe UI Emoji" font-size="16.511815877949395px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Kafka choose partition to receive messages from producer by hash(object) % #partitions or we defined a key</text></g><g transform="translate(190.0119631820237 68.39995574951172) rotate(0 426.5 30)"><text x="0" y="15" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Before a producer can send any records, it has to request metadata about the cluster from the broker. </text><text x="0" y="35" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">The metadata contains information on which broker is the leader for each partition and</text><text x="0" y="55" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">a producer always writes to the partition leader. </text></g><g transform="translate(398.01193266444557 10) rotate(0 167 23)"><text x="0" y="32" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#0b7285" text-anchor="start" style="white-space: pre;" direction="ltr">Producer =&gt; Kafka</text></g><g transform="translate(538.0119326644456 171.8000259399414) rotate(0 109 37)"><text x="0" y="17.666666666666668" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">No ack</text><text x="0" y="42.333333333333336" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Ack (Leader done)</text><text x="0" y="67" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Ack (all replicas done)</text></g></svg>